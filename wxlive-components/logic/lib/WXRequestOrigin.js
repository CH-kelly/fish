function e(e,o){var t={};for(var r in e)o.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}function o(e){return new Promise(function(t,r){(e=e||0)>2?(wx.showModal({content:"mock server wx.login 调用失败",showCancel:!1}),r()):(console.log("MOCKServerWxLogin wxlogin"),wx.login({success:function(r){console.log("步骤1：获取code"),console.log(r.code),r.code?t(r.code):o(++e)},fail:function(t){console.log("mock server wx login catch"),console.log(t),t.errMsg&&t.errMsg.indexOf("-12015")>0&&(wx.showModal({content:"插件页，需先用功能页登录，具体操作参照mock server 中的faq",showCancel:!1}),r()),o(++e)}}))})}function t(e,o,t,r){return new Promise(function(n,c,s){try{console.log("MOCKServerWxRequestCommon recordReqData"),console.log(t),wx.request({url:e,method:o,data:t,header:r,success:function(e){n(e)},fail:function(e){c(e)},complete:function(e){}})}catch(e){console.log("common catch err"),console.log(e)}})}function r(e){switch(e){case"operateWXData":return wx.operateWXData;case"cloud":return wx.cloud;case"request":return wx.request}}function n(o,t,r){var n=e(t,[]),s=(n[0].method||"POST").toUpperCase(),a="POST"===s?{body:n[0].reqData,query:(0,c.MOCKServerGetUrlQuery)(n[0].apiName.split("?")[1])}:{body:{},query:Object.assign((0,c.MOCKServerGetUrlQuery)(n[0].apiName.split("?")[1]),n[0].reqData)},i="/"+n[0].apiName,l=JSON.stringify({path:o.configsFrom+"__"+(0,c._randomName)(5),testCase:JSON.stringify(r)});return{rtx:o.configsRtx,date:Date.parse(new Date).toString(),contentType:"application/json; charset=UTF-8",method:s,from:o.configsFrom,project:JSON.stringify({path:o.configsTarget}),cgi:JSON.stringify({path:i}),reqdata:JSON.stringify(a),testcase:l}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.MOCKServerWxLogin=exports.MOCKServerKidnap=exports.MOCKServerWxRequestCommon=exports.MOCKServerWxGetRtx=void 0;var c=require("./libs.js");exports.MOCKServerWxGetRtx=function(e,o){return new Promise(function(r,n){console.log("MOCKServerWxGetRtx promise"),t("https://oa.m.tencent.com/__code2key/?code="+e+"&app="+o,"GET",void 0,{"content-type":"application/json"}).then(function(e){console.log("MOCKServerWxGetRtx"),console.log(e)}).catch(function(e){console.log("mock server catch MOCKServerWxGetRtx err"),console.log(e)})})},exports.MOCKServerWxRequestCommon=t,exports.MOCKServerKidnap=function(e,o,s){console.log("MOCKServerKidnap");var a=r(o);Object.defineProperty(e,o,{configurable:!0,enumerable:!0,writable:!0,value:function(){var e=arguments,o=arguments;switch(s.configsType){case"record":return o[0].success=(0,c._witHookAfter)(arguments[0].success,function(e){console.log("_witHookAfter success"),console.log(e);var r=n(s,o,e);t(s.requestRecordTargetOriginal,"post",r)}),a.apply(this,o);case"play":t(""+s.requestPlayTargetOriginal+o[0].apiName,"POST",Object.assign({rtx:s.configsRtx},o[0].reqData)).then(function(o){e[0].success?e[0].success(o.data):e[0].complete&&e[0].complete(o.data)}).catch(function(o){e[0].fail(o)})}}})},exports.MOCKServerWxLogin=o;